---
title: "ツリーシェイキングと副作用 ツリーシェイキングが効く時と効かない時"
emoji: "🌳"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["JavaScript", "TypeScript", "React"]
published: false
---

# ツリーシェイキングとは

WebpackやViteなどの現代的なバンドルツールが持つプロセスの一つで、プログラム内の未使用の部分（使われていない関数や変数など）を自動で削除してくれる最適化処理です。
これにより、未使用の関数や変数、ライブラリの一部などはバンドルサイズに含まれなくなります。たとえば、`node_modules`内のライブラリでも、使っていない部分はバンドルから除外されます（ただし形式や副作用によっては除外されない場合もあります）。
名前は、木を揺らして不要な葉を落とすことに例えています。

![ツリーシェイキングのイメージ](https://storage.googleapis.com/zenn-user-upload/6765e27768ab-20250614.gif)

# `rollup-plugin-visualizer`でバンドルファイルを可視化

# ツリーシェイキングが効くための前提の話

- ESM形式である
- バンドルツールを使っている

# 効かない時1：全部同じファイル内にある時

# 効かない時2: `*`でまとめてエクスポートされてる時

# 効かない時3: 副作用が効いている時

# 補足：`sideEffect: false`で副作用を無効化

# バンドルサイズを小さくするために気をつけること